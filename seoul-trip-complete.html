<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Seoul Trip</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‡°ğŸ‡·</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        :root{--primary:#ff6b6b;--bg:#f7f7f9;--white:#fff;--text:#1a1a1a;--text-sec:#888;--border:rgba(0,0,0,0.05);--shadow:0 1px 4px rgba(0,0,0,0.06);--food:#ff6b6b;--cafe:#f6b93b;--shop:#a55eea;--work:#4a90d9;--accom:#26de81;--attr:#fd9644}
        *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
        body{margin:0;font-family:'Noto Sans TC',-apple-system,sans-serif;background:var(--bg);color:var(--text);padding-bottom:62px}
        .header{background:var(--white);padding:8px 16px;position:sticky;top:0;z-index:1000;display:flex;justify-content:space-between;align-items:center;box-shadow:var(--shadow);height:48px}
        .title{font-size:1rem;font-weight:700;display:flex;align-items:center;gap:6px}
        .title svg{color:var(--primary);width:18px;height:18px}
        .search-toggle{background:transparent;border:none;cursor:pointer;padding:6px;display:flex;align-items:center;justify-content:center;position:relative;z-index:1300;flex-shrink:0}
        .search-toggle svg{color:var(--primary);width:20px;height:20px}
        .search-wrap{position:fixed;top:10px;right:12px;height:40px;background:var(--white);z-index:1100;display:none;align-items:center;border-radius:20px;border:1px solid #e0e0e0;width:40px;overflow:hidden;transition:width 0.4s cubic-bezier(0.4, 0, 0.2, 1)}
        .search-wrap.show{display:flex}
        .search-wrap.open{pointer-events:auto;width:calc(100% - 180px)}
        .search-box{display:flex;align-items:center;background:transparent;padding:0 12px;gap:10px;width:100%;opacity:0;transition:opacity 0.3s ease}
        .search-wrap.open .search-box{opacity:1;transition-delay:0.15s}
        .search-box svg{color:#bbb;flex-shrink:0}
        .search-box input{border:none;outline:none;font-size:0.95rem;width:100%;background:transparent;font-family:inherit}
        .search-clear{background:#eee;border:none;width:20px;height:20px;border-radius:50%;cursor:pointer;display:none;align-items:center;justify-content:center;font-size:12px;color:#888;margin-right:8px}
        .search-clear.show{display:flex}
        .search-close{background:transparent;border:none;cursor:pointer;padding:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .search-close svg{color:var(--text)}
        .tabs{position:sticky;top:48px;z-index:900;background:var(--bg);padding:6px 0 8px;overflow-x:auto;white-space:nowrap}
        .tabs::-webkit-scrollbar{display:none}
        .tabs-inner{padding:0 16px}
        .tab{display:inline-flex;align-items:center;gap:4px;margin-right:6px;padding:6px 12px;background:var(--white);border-radius:16px;font-size:0.8rem;font-weight:600;color:var(--text-sec);border:none;cursor:pointer;box-shadow:var(--shadow)}
        .tab.active{background:var(--text);color:white}
        .tab-count{font-size:0.7rem;background:rgba(0,0,0,0.08);padding:2px 6px;border-radius:10px;min-width:18px;text-align:center}
        .tab.active .tab-count{background:rgba(255,255,255,0.25)}
        .zones{padding:0 16px 6px;overflow-x:auto;white-space:nowrap}
        .zones::-webkit-scrollbar{display:none}
        .zone-pill{display:inline-block;padding:4px 10px;background:transparent;border:1px solid #ddd;border-radius:14px;font-size:0.72rem;color:#666;margin-right:5px;cursor:pointer}
        .zone-pill.active{background:var(--text);color:white;border-color:var(--text)}
        .container{max-width:600px;margin:0 auto;padding:4px 16px}
        .result-info{padding:8px 4px 12px;font-size:0.8rem;color:var(--text-sec)}
        .card{background:var(--white);border-radius:14px;padding:16px;margin-bottom:12px;box-shadow:var(--shadow)}
        .card-badges{display:flex;gap:6px;margin-bottom:10px}
        .badge-cat{font-size:0.68rem;padding:4px 10px;border-radius:10px;font-weight:600;color:white}
        .badge-zone{font-size:0.68rem;padding:4px 10px;border-radius:10px;background:#f0f0f2;color:#666}
        .cat-ç¾é£Ÿ,.cat-æ—©åˆé¤{background:var(--food)}
        .cat-å’–å•¡ç”œé»{background:var(--cafe)}
        .cat-è³¼ç‰©,.cat-é¸ç‰©,.cat-æœé£¾,.cat-å½©å¦,.cat-é›œè²¨{background:var(--shop)}
        .cat-Work,.cat-å±•è¦½,.cat-å·¥ä½œå’–å•¡{background:var(--work)}
        .cat-ä½å®¿{background:var(--accom)}
        .cat-æ™¯é»{background:var(--attr)}
        .name-cn{font-size:1.1rem;font-weight:700;margin-bottom:3px}
        .name-kr{font-size:0.82rem;color:var(--text-sec);margin-bottom:10px}
        .info{font-size:0.8rem;color:#666;margin-bottom:4px}
        .must{background:linear-gradient(135deg,#fffbeb 0%,#fef3c7 100%);border-left:3px solid #f59e0b;border-radius:10px;padding:12px;margin:12px 0}
        .must-title{font-size:0.72rem;font-weight:700;color:#d97706;margin-bottom:6px}
        .must-text{font-size:0.85rem;color:#333;line-height:1.5}
        .price{display:inline-block;background:white;color:#666;font-size:0.72rem;padding:4px 10px;border-radius:8px;margin-top:8px}
        .actions{margin-top:14px;display:flex;gap:8px}
        .btn{flex:1;padding:11px;text-align:center;border-radius:10px;font-weight:600;text-decoration:none;font-size:0.82rem}
        .btn-g{background:#e3f2fd;color:#1976d2}
        .btn-n{background:#e8f5e9;color:#2e7d32}
        .nav{position:fixed;bottom:0;left:0;right:0;background:var(--white);border-top:1px solid var(--border);display:flex;justify-content:space-around;padding:4px 0 calc(4px + env(safe-area-inset-bottom));z-index:1100}
        .nav-item{display:flex;flex-direction:column;align-items:center;padding:6px 24px;color:#c0c0c0;text-decoration:none;background:none;border:none;cursor:pointer}
        .nav-item.active{color:var(--primary)}
        .nav-item svg{margin-bottom:2px;width:20px;height:20px}
        .nav-label{font-size:0.65rem;font-weight:600}
        .page{display:none}
        .page.active{display:block}
        .placeholder{display:flex;align-items:center;justify-content:center;height:70vh;color:#888;text-align:center;flex-direction:column}
        .schedule-tabs{display:flex;overflow-x:auto;background:var(--white);padding:12px 16px;gap:8px;position:sticky;top:60px;z-index:500;border-bottom:1px solid #f0f0f0}
        .schedule-tabs::-webkit-scrollbar{display:none}
        .schedule-tab{flex-shrink:0;padding:10px 16px;background:var(--white);border:2px solid #e0e0e0;border-radius:12px;font-size:0.85rem;font-weight:600;color:var(--text-sec);cursor:pointer;text-align:center;transition:all 0.2s ease}
        .schedule-tab span{display:block;font-size:0.75rem;margin-top:4px;color:#999}
        .schedule-tab.active{background:var(--primary);color:white;border-color:var(--primary)}
        .schedule-tab.active span{color:rgba(255,255,255,0.9)}
        .schedule-content{padding:16px}
        .schedule-day{display:none}
        .schedule-day.active{display:block}
        .day-title{font-size:1.1rem;font-weight:700;color:var(--text);margin-bottom:16px;padding-bottom:8px;border-bottom:2px solid var(--primary)}
        .schedule-item{display:flex;gap:16px;margin-bottom:20px;padding:16px;background:var(--white);border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.06)}
        .schedule-item .time{flex-shrink:0;width:70px;font-size:0.85rem;font-weight:600;color:var(--primary);padding-top:2px}
        .schedule-item .content{flex:1}
        .event-title{font-size:1rem;font-weight:600;color:var(--text);margin-bottom:6px}
        .event-detail{font-size:0.85rem;color:var(--text-sec);margin-bottom:3px}
        .schedule-item.flight{border-left:4px solid #4285f4}
        .schedule-item.work{border-left:4px solid #a55eea}
        .schedule-item.special{border-left:4px solid #ff6b6b}
        .schedule-item.free{border-left:4px solid #26de81}
        .footer{text-align:center;padding:24px;color:#ccc;font-size:0.72rem}
        #map-wrap{position:fixed;top:0;left:0;width:100%;height:calc(100% - 70px);background:white;z-index:800;display:none}
        #map-wrap.active{display:flex}
        #map{flex:1;width:100%;height:100%}
        .map-sidebar{width:100%;max-width:360px;height:100%;background:var(--white);border-right:1px solid #e0e0e0;overflow-y:auto;display:flex;flex-direction:column}
        @media (max-width:768px){.map-sidebar{max-width:280px}}
        .map-list{flex:1;overflow-y:auto;padding:60px 0 16px}
        .map-list-item{padding:12px 16px;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background 0.2s ease}
        .map-list-item:hover{background:#f7f7f9}
        .map-list-item.active{background:#fff8f0;border-left:3px solid var(--primary)}
        .map-item-name{font-size:0.95rem;font-weight:600;color:var(--text);margin-bottom:4px}
        .map-item-info{font-size:0.8rem;color:var(--text-sec);margin-bottom:6px}
        .map-item-links{display:flex;gap:8px}
        .map-item-link{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:#f7f7f9;transition:all 0.2s ease;text-decoration:none}
        .map-item-link:hover{background:#e0e0e0;transform:translateY(-2px)}
        .map-item-link svg{width:18px;height:18px}
        .map-controls{position:absolute;top:60px;left:16px;right:16px;z-index:2000;display:flex;gap:8px;flex-wrap:wrap;pointer-events:none}
        .map-controls *{pointer-events:auto}
        .map-filter{position:relative}
        .map-filter-btn{padding:10px 16px;background:var(--white);border:none;border-radius:20px;font-size:0.9rem;font-weight:600;color:var(--text);cursor:pointer;display:flex;align-items:center;gap:8px;font-family:inherit;min-width:160px;box-shadow:0 2px 8px rgba(0,0,0,0.08)}
        .map-filter-btn svg{width:16px;height:16px;transition:transform 0.3s ease}
        .map-filter-btn.open svg{transform:rotate(180deg)}
        .map-filter-dropdown{position:absolute;top:calc(100% + 8px);left:0;background:var(--white);border:none;border-radius:12px;min-width:160px;display:none;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.08)}
        .map-filter-dropdown.show{display:block}
        .map-filter-option{padding:10px 16px;cursor:pointer;font-size:0.9rem;font-weight:500;display:flex;align-items:center;gap:8px;color:var(--text);transition:background 0.2s ease}
        .map-filter-option:hover{background:#f7f7f9}
        .map-filter-option.active{background:var(--text);color:white}
        .map-btn{padding:8px 14px;background:white;border:none;border-radius:20px;font-size:0.8rem;font-weight:600;color:#666;box-shadow:0 2px 8px rgba(0,0,0,0.15);cursor:pointer}
        .map-btn.active{background:var(--text);color:white}
        .locate-btn{position:absolute;bottom:90px;right:16px;width:44px;height:44px;background:white;border:none;border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,0.2);cursor:pointer;z-index:1000;display:flex;align-items:center;justify-content:center}
        .custom-marker{width:28px;height:28px;border-radius:50% 50% 50% 0;transform:rotate(-45deg);display:flex;align-items:center;justify-content:center;box-shadow:0 2px 6px rgba(0,0,0,0.3);border:2px solid white}
        .custom-marker span{transform:rotate(45deg);font-size:12px}
        .marker-ç¾é£Ÿ,.marker-æ—©åˆé¤{background:#ff6b6b}
        .marker-å’–å•¡ç”œé»{background:#f6b93b}
        .marker-è³¼ç‰©,.marker-æœé£¾,.marker-é¸ç‰©,.marker-å½©å¦,.marker-é›œè²¨{background:#a55eea}
        .marker-Work,.marker-å·¥ä½œå’–å•¡,.marker-å±•è¦½{background:#4a90d9}
        .marker-ä½å®¿{background:#26de81}
        .marker-æ™¯é»{background:#fd9644}
        .my-marker{width:16px;height:16px;background:#4285f4;border:3px solid white;border-radius:50%;box-shadow:0 2px 6px rgba(66,133,244,0.5)}
        .leaflet-popup-content-wrapper{border-radius:12px}
        .popup-nav{display:block;margin-top:8px;background:#03C75A;color:white;text-align:center;padding:8px;border-radius:8px;text-decoration:none;font-size:0.8rem;font-weight:600}
        .empty{text-align:center;padding:60px 20px;color:var(--text-sec)}

        
        
        /* Optimized Schedule Styles */
        .schedule-wrapper{background:linear-gradient(180deg, #fafafa 0%, #f5f5f7 100%);min-height:100vh}
        .schedule-header{padding:12px 16px 8px;background:var(--white);position:sticky;top:48px;z-index:800;box-shadow:0 2px 8px rgba(0,0,0,0.04)}
        .schedule-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
        .schedule-date{font-size:0.8rem;color:var(--text-sec);font-weight:500}
        .today-btn{padding:6px 14px;background:var(--primary);color:white;border:none;border-radius:20px;font-size:0.8rem;font-weight:600;cursor:pointer;transition:all 0.2s ease}
        .today-btn:active{transform:scale(0.95)}
        .schedule-today{font-size:1.5rem;font-weight:700;color:var(--text);margin-bottom:8px;letter-spacing:-0.5px}
        .week-calendar{display:flex;gap:6px;overflow-x:auto;padding-bottom:8px;scroll-behavior:smooth}
        .week-calendar::-webkit-scrollbar{display:none}
        .week-day{flex-shrink:0;text-align:center;min-width:44px;cursor:pointer;transition:all 0.25s cubic-bezier(0.4, 0, 0.2, 1);padding:6px 4px;border-radius:10px}
        .week-day:hover{background:rgba(0,0,0,0.02)}
        .week-day-label{font-size:0.7rem;color:var(--text-sec);margin-bottom:4px;font-weight:600;letter-spacing:0.3px;text-transform:uppercase}
        .week-day-num{font-size:0.95rem;font-weight:700;color:var(--text);width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:50%;margin:0 auto;transition:all 0.25s ease}
        .week-day.active .week-day-label{color:var(--primary)}
        .week-day.active .week-day-num{background:var(--primary);color:white;box-shadow:0 2px 8px rgba(255,107,107,0.3)}
        .week-day.today .week-day-num{border:2px solid var(--primary)}
        .week-day-dot{width:4px;height:4px;background:var(--primary);border-radius:50%;margin:6px auto 0;opacity:0;transition:opacity 0.2s ease}
        .week-day.active .week-day-dot{opacity:1}
        
        .schedule-content{padding:0;background:transparent;position:relative;touch-action:pan-y}
        .hourly-schedule{padding:16px 0 100px;max-width:600px;margin:0 auto}
        .current-time-line{position:absolute;left:80px;right:20px;height:2px;background:var(--primary);z-index:100;pointer-events:none;box-shadow:0 0 8px rgba(255,107,107,0.4)}
        .current-time-line::before{content:'';position:absolute;left:-6px;top:-4px;width:10px;height:10px;background:var(--primary);border-radius:50%;box-shadow:0 0 0 3px rgba(255,107,107,0.2)}
        .current-time-label{position:absolute;left:12px;top:-10px;background:var(--primary);color:white;font-size:0.7rem;padding:2px 8px;border-radius:10px;font-weight:700;white-space:nowrap}
        
        .hour-block{display:flex;gap:12px;position:relative;min-height:70px}
        .hour-block.past{opacity:0.5}
        .hour-time{flex-shrink:0;width:60px;padding:4px 12px 0 16px;font-size:0.85rem;font-weight:700;color:var(--text-sec);text-align:right;position:sticky;top:110px;z-index:10}
        .hour-line{position:relative;flex:1;padding:0 16px 0 0}
        .hour-line::before{content:'';position:absolute;left:0;top:8px;bottom:-10px;width:1px;background:linear-gradient(180deg, #e5e5e5 0%, #f0f0f0 100%)}
        .hour-dot{position:absolute;left:-3px;top:8px;width:6px;height:6px;border-radius:50%;background:#d0d0d0;z-index:1;transition:all 0.2s ease}
        .hour-block:hover .hour-dot{background:var(--primary);transform:scale(1.3)}
        
        .event-card{background:white;border-radius:14px;padding:14px;margin-bottom:10px;box-shadow:0 1px 3px rgba(0,0,0,0.08);transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);border-left:3px solid transparent;cursor:pointer;position:relative;overflow:hidden}
        .event-card::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0) 100%);opacity:0;transition:opacity 0.3s ease}
        .event-card:hover{box-shadow:0 4px 16px rgba(0,0,0,0.12);transform:translateY(-2px) translateX(2px)}
        .event-card:hover::before{opacity:1}
        .event-card:active{transform:translateY(0) translateX(0);box-shadow:0 2px 8px rgba(0,0,0,0.1)}
        
        .event-card.flight{background:linear-gradient(135deg,#e3f2fd 0%,#f8fbff 100%);border-left-color:#2196f3}
        .event-card.work{background:linear-gradient(135deg,#f3e5f5 0%,#fdf9fe 100%);border-left-color:#9c27b0}
        .event-card.food{background:linear-gradient(135deg,#fff3e0 0%,#fffcf7 100%);border-left-color:#ff9800}
        .event-card.activity{background:linear-gradient(135deg,#e8f5e9 0%,#f7fcf8 100%);border-left-color:#4caf50}
        .event-card.special{background:linear-gradient(135deg,#fce4ec 0%,#fff8fa 100%);border-left-color:#e91e63}
        
        .event-title-text{font-size:1rem;font-weight:700;color:var(--text);margin-bottom:8px;display:flex;align-items:center;gap:6px;line-height:1.3}
        .event-title-text svg{flex-shrink:0;opacity:0.8}
        .event-meta{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:6px}
        .event-time-detail{font-size:0.75rem;color:var(--text-sec);display:flex;align-items:center;gap:4px;font-weight:600}
        .event-time-detail svg{width:13px;height:13px;opacity:0.7}
        .event-tag{display:inline-block;padding:3px 9px;border-radius:10px;font-size:0.7rem;font-weight:700;letter-spacing:0.3px}
        .event-card.flight .event-tag{background:rgba(33,150,243,0.15);color:#1976d2}
        .event-card.work .event-tag{background:rgba(156,39,176,0.15);color:#7b1fa2}
        .event-card.food .event-tag{background:rgba(255,152,0,0.15);color:#f57c00}
        .event-card.activity .event-tag{background:rgba(76,175,80,0.15);color:#388e3c}
        .event-card.special .event-tag{background:rgba(233,30,99,0.15);color:#c2185b}
        .event-desc{font-size:0.82rem;color:var(--text-sec);line-height:1.5;margin-top:8px;opacity:0.9}
        
        .event-expanded{max-height:500px;transition:max-height 0.3s ease}
        .event-collapsed{max-height:90px;overflow:hidden}
        
        .empty-slot{background:rgba(0,0,0,0.02);border-radius:8px;padding:20px;text-align:center;color:var(--text-sec);font-size:0.8rem;margin:8px 0;border:1px dashed #e0e0e0}
        
        .no-events{text-align:center;padding:80px 20px;color:var(--text-sec)}
        .no-events svg{margin-bottom:16px;opacity:0.2}
        .no-events p{font-size:0.95rem;font-weight:500}
        
        @media (max-width: 480px){
            .hour-time{width:50px;font-size:0.8rem}
            .schedule-today{font-size:1.6rem}
            .event-card{padding:12px}
        }


    </style>
</head>
<body>
    <div class="header">
        <div class="title">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="11" r="3"/><path d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.828 0l-4.243 -4.243a8 8 0 1 1 11.314 0z"/></svg>
            Seoul Trip
        </div>
        <button class="search-toggle" onclick="toggleSearch()">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        </button>
    </div>
    <div class="search-wrap" id="search-wrap">
        <div class="search-box">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" id="search" placeholder="æœå°‹åº—åã€åœ°å€...">
            <button class="search-clear" id="clear" onclick="clearSearch()"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        </div>
        <button class="search-close" onclick="toggleSearch()">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
    </div>
    <div id="page-pins" class="page active">
        <div class="tabs"><div class="tabs-inner" id="tabs"></div></div>
        <div class="zones" id="zones"></div>
        <div class="container">
            <div class="result-info" id="info"></div>
            <div id="list"></div>
        </div>
        <div class="footer">Made with 
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin:0 2px"><path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572"/></svg> for Tina
        </div>
    </div>
        <div id="page-schedule" class="page">
        <div class="schedule-wrapper">
            <div class="schedule-header">
                <div class="schedule-top">
                    <div class="schedule-date" id="schedule-current-date">Feb 23, 2026</div>
                    <button class="today-btn" onclick="jumpToToday()">Today</button>
                </div>
                <div class="schedule-today">Day <span id="schedule-day-num">1</span></div>
                <div class="week-calendar" id="week-calendar">
                    <div class="week-day active today" data-day="0">
                        <div class="week-day-label">Mon</div>
                        <div class="week-day-num">23</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="1">
                        <div class="week-day-label">Tue</div>
                        <div class="week-day-num">24</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="2">
                        <div class="week-day-label">Wed</div>
                        <div class="week-day-num">25</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="3">
                        <div class="week-day-label">Thu</div>
                        <div class="week-day-num">26</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="4">
                        <div class="week-day-label">Fri</div>
                        <div class="week-day-num">27</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="5">
                        <div class="week-day-label">Sat</div>
                        <div class="week-day-num">28</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="6">
                        <div class="week-day-label">Sun</div>
                        <div class="week-day-num">1</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="7">
                        <div class="week-day-label">Mon</div>
                        <div class="week-day-num">2</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="8">
                        <div class="week-day-label">Tue</div>
                        <div class="week-day-num">3</div>
                        <div class="week-day-dot"></div>
                    </div>
                    <div class="week-day" data-day="9">
                        <div class="week-day-label">Wed</div>
                        <div class="week-day-num">4</div>
                        <div class="week-day-dot"></div>
                    </div>
                </div>
            </div>
            <div class="schedule-content" id="schedule-content">
                <div id="timeline-container"></div>
            </div>
        </div>
    </div>
    <div id="map-wrap">
        <div class="map-sidebar">
            <div class="map-list" id="map-list"></div>
        </div>
        <div style="flex:1;position:relative">
            <div class="map-controls">
                <div class="map-filter">
                    <button class="map-filter-btn" onclick="toggleMapFilter()" id="map-filter-btn">
                        <span id="map-filter-text"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><circle cx="12" cy="11" r="3"/><path d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.828 0l-4.243 -4.243a8 8 0 1 1 11.314 0z"/></svg>å…¨éƒ¨åœ°æ¨™</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="map-filter-dropdown" id="map-filter-dropdown">
                        <div class="map-filter-option active" data-value="all" data-label="å…¨éƒ¨åœ°æ¨™">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><circle cx="12" cy="11" r="3"/><path d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.828 0l-4.243 -4.243a8 8 0 1 1 11.314 0z"/></svg>å…¨éƒ¨åœ°æ¨™
                        </div>
                        <div class="map-filter-option" data-value="ç¾é£Ÿ" data-label="ç¾é£Ÿ">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><path d="M4 8h16a1 1 0 0 1 1 1v.5c0 1.5 -2.517 5.573 -4 6.5v1a1 1 0 0 1 -1 1h-8a1 1 0 0 1 -1 -1v-1c-1.687 -1.054 -4 -5 -4 -6.5v-.5a1 1 0 0 1 1 -1z"/><path d="M12 4a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"/></svg>ç¾é£Ÿ
                        </div>
                        <div class="map-filter-option" data-value="å’–å•¡ç”œé»" data-label="å’–å•¡ç”œé»">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><path d="M3 14c.83 .642 2.077 1.017 3.5 1c1.423 .017 2.67 -.358 3.5 -1c.83 -.642 2.077 -1.017 3.5 -1c1.423 -.017 2.67 .358 3.5 1"/><path d="M8 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"/><path d="M12 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"/><path d="M3 10h14v5a6 6 0 0 1 -6 6h-2a6 6 0 0 1 -6 -6v-5z"/><path d="M16.746 16.726a3 3 0 1 0 .252 -5.555"/></svg>å’–å•¡ç”œé»
                        </div>
                        <div class="map-filter-option" data-value="è³¼ç‰©" data-label="è³¼ç‰©">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><path d="M6.331 8h11.339a2 2 0 0 1 1.977 2.304l-1.255 8.152a3 3 0 0 1 -2.966 2.544h-6.852a3 3 0 0 1 -2.965 -2.544l-1.255 -8.152a2 2 0 0 1 1.977 -2.304z"/><path d="M9 11v-5a3 3 0 0 1 6 0v5"/></svg>è³¼ç‰©
                        </div>
                        <div class="map-filter-option" data-value="Work" data-label="Work">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><rect x="3" y="5" width="18" height="14" rx="1"/><path d="M7 15v-6l2 2l2 -2v6"/><path d="M14 10h2"/><path d="M14 13h2"/></svg>Work
                        </div>
                        <div class="map-filter-option" data-value="ä½å®¿" data-label="ä½å®¿">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><path d="M5 12l-2 0l9 -9l9 9l-2 0l0 7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"/></svg>ä½å®¿
                        </div>
                        <div class="map-filter-option" data-value="å±•è¦½" data-label="å±•è¦½">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25"/><circle cx="7.5" cy="10.5" r=".5" fill="currentColor"/><circle cx="12" cy="7.5" r=".5" fill="currentColor"/><circle cx="16.5" cy="10.5" r=".5" fill="currentColor"/></svg>å±•è¦½
                        </div>
                        <div class="map-filter-option" data-value="æ™¯é»" data-label="æ™¯é»">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:4px"><path d="M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2"/><circle cx="12" cy="13" r="3"/></svg>æ™¯é»
                        </div>
                    </div>
                </div>
            </div>
            <div id="map"></div>
            <button class="locate-btn" onclick="locate()">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#4285f4" stroke-width="2.5"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4m10-10h-4M6 12H2"/></svg>
            </button>
        </div>
    </div>
    <nav class="nav">
        <button class="nav-item active" onclick="go(0)">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="11" r="3"/><path d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.828 0l-4.243 -4.243a8 8 0 1 1 11.314 0z"/></svg>
            <span class="nav-label">æ™¯é»</span>
        </button>
        <button class="nav-item" onclick="go(1)">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="5" width="16" height="16" rx="2"/><line x1="16" y1="3" x2="16" y2="7"/><line x1="8" y1="3" x2="8" y2="7"/><line x1="4" y1="11" x2="20" y2="11"/></svg>
            <span class="nav-label">è¡Œç¨‹</span>
        </button>
        <button class="nav-item" onclick="go(2)">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>
            <span class="nav-label">åœ°åœ–</span>
        </button>
    </nav>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>

var SCHEDULE_HOURLY = {
    0: [ // Day 1
        {hour: 18, duration: 3.5, title: 'æ¡ƒåœ’ â†’ ä»å·', desc: 'TR 896 [Scoot B787-9]\nTaoyuan Intl Airport Terminal 1', tag: 'èˆªç­', type: 'flight', icon: 'plane'},
        {hour: 21, duration: 0.5, title: 'æŠµé”é¦–çˆ¾', desc: 'Incheon Intl (ICN) Terminal 1', tag: 'æŠµé”', type: 'flight', icon: 'plane-arrival'},
        {hour: 23, duration: 1, title: 'Check-in ä½å®¿', desc: '43 Gyeongdongsijang-ro 12-gil', tag: 'ä½å®¿', type: 'activity', icon: 'home'}
    ],
    1: [ // Day 2
        {hour: 10, duration: 10, title: 'å·¥ä½œæ—¥', desc: 'Tina & Bian å·¥ä½œæ™‚é–“\n13:00 åˆé¤', tag: 'å·¥ä½œ', type: 'work', icon: 'briefcase'}
    ],
    2: [ // Day 3
        {hour: 10, duration: 10, title: 'å·¥ä½œæ—¥', desc: 'Tina & Bian å·¥ä½œæ™‚é–“\n13:00 åˆé¤', tag: 'å·¥ä½œ', type: 'work', icon: 'briefcase'}
    ],
    3: [ // Day 4
        {hour: 10, duration: 8, title: 'Free Day', desc: 'è‡ªç”±è¡Œç¨‹ï¼Œéš¨æ„å®‰æ’', tag: 'è‡ªç”±æ´»å‹•', type: 'activity', icon: 'confetti'}
    ],
    4: [ // Day 5
        {hour: 10, duration: 10, title: 'é€›è¡— / åŒ—æ‘+å¤œæ™¯', desc: 'æ¢ç´¢é¦–çˆ¾å‚³çµ±èˆ‡ç¾ä»£', tag: 'è§€å…‰', type: 'activity', icon: 'lantern'}
    ],
    5: [ // Day 6
        {hour: 9, duration: 10, title: 'Eobi å†°è°· & å—æ€¡å³¶', desc: 'ä¸€æ—¥éŠè¡Œç¨‹', tag: 'æˆ¶å¤–æ´»å‹•', type: 'activity', icon: 'mountain'}
    ],
    6: [ // Day 7
        {hour: 9, duration: 1, title: 'é€šå‹¤', desc: 'ç´„ä¸€å°æ™‚è»Šç¨‹', tag: 'äº¤é€š', type: 'activity', icon: 'car'},
        {hour: 11, duration: 3, title: 'Wedding', desc: 'å©šç¦®å…¸ç¦®', tag: 'ç‰¹åˆ¥æ´»å‹•', type: 'special', icon: 'church'},
        {hour: 15, duration: 4, title: 'ä»å· or é€›è¡—', desc: 'è‡ªç”±æ´»å‹•æ™‚é–“', tag: 'è³¼ç‰©', type: 'activity', icon: 'shopping-bag'}
    ],
    7: [ // Day 8
        {hour: 9, duration: 10, title: 'åŒ—ç·¯ 38 åº¦ç·š', desc: 'DMZ ä¸€æ—¥éŠ', tag: 'è§€å…‰', type: 'activity', icon: 'world'}
    ],
    8: [ // Day 9
        {hour: 10, duration: 8, title: 'æ©å¹³éŸ“å±‹æ‘', desc: 'é«”é©—å‚³çµ±éŸ“å±‹', tag: 'æ–‡åŒ–é«”é©—', type: 'activity', icon: 'building-monument'}
    ],
    9: [ // Day 10
        {hour: 10, duration: 10, title: 'é€›è¡— + æœ€å¾Œæ¡è³¼', desc: 'æº–å‚™å›å®¶å›‰', tag: 'è³¼ç‰©', type: 'activity', icon: 'shopping-bag'},
        {hour: 23, duration: 1.75, title: 'ä»å· â†’ æ¡ƒåœ’', desc: 'TR 897 [Scoot B787-9]\nIncheon Intl Terminal 1', tag: 'èˆªç­', type: 'flight', icon: 'plane'}
    ]
};

var ICONS = {
    'plane': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 10h4a2 2 0 0 1 0 4h-4l-4 7h-3l2 -7h-4l-2 2h-3l2 -4l-2 -4h3l2 2h4l-2 -7h3z"/></svg>',
    'plane-arrival': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 12h5a2 2 0 0 1 0 4h-15l-3 6h-2l2 -8h-2l-2 2h-2l2 -4l-2 -4h2l2 2h2l-2 -8h2l3 6h10a2 2 0 0 1 0 4h-5z"/></svg>',
    'home': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12l-2 0l9 -9l9 9l-2 0l0 7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"/></svg>',
    'briefcase': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"/><path d="M8 7v-2a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v2"/><path d="M12 12l0 .01"/><path d="M3 13a20 20 0 0 0 18 0"/></svg>',
    'bowl': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 8h16a1 1 0 0 1 1 1v.5c0 1.5 -2.517 5.573 -4 6.5v1a1 1 0 0 1 -1 1h-8a1 1 0 0 1 -1 -1v-1c-1.687 -1.054 -4 -5 -4 -6.5v-.5a1 1 0 0 1 1 -1z"/><path d="M12 4a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"/></svg>',
    'confetti': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 5h2"/><path d="M5 4v2"/><path d="M11.5 4l-.5 2"/><path d="M18 5h2"/><path d="M19 4v2"/><path d="M15 9l-1 1"/><path d="M18 13l2 -.5"/><path d="M18 19h2"/><path d="M19 18v2"/><path d="M14 16.518l-6.518 -6.518l-4.39 9.58a1 1 0 0 0 1.329 1.329l9.579 -4.39z"/></svg>',
    'lantern': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 2h6l3 7l-3 7h-6l-3 -7z"/><path d="M12 16v4"/><path d="M10 20h4"/></svg>',
    'mountain': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 20h18l-6.921 -14.612a2.3 2.3 0 0 0 -4.158 0l-6.921 14.612z"/><path d="M7.5 11l2 2.5l2.5 -2.5l2 3l2.5 -2"/></svg>',
    'car': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/><path d="M5 17h-2v-6l2 -5h9l4 5h1a2 2 0 0 1 2 2v4h-2m-4 0h-6m-6 -6h15m-6 0v-5"/></svg>',
    'church': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 21h18"/><path d="M10 21v-4a2 2 0 0 1 2 -2h0a2 2 0 0 1 2 2v4"/><path d="M10 5l2 -2l2 2"/><path d="M6 21v-7m-2 2l8 -8l8 8m-2 -2v7"/></svg>',
    'shopping-bag': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6.331 8h11.339a2 2 0 0 1 1.977 2.304l-1.255 8.152a3 3 0 0 1 -2.966 2.544h-6.852a3 3 0 0 1 -2.965 -2.544l-1.255 -8.152a2 2 0 0 1 1.977 -2.304z"/><path d="M9 11v-5a3 3 0 0 1 6 0v5"/></svg>',
    'world': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9"/><path d="M3.6 9h16.8"/><path d="M3.6 15h16.8"/><path d="M11.5 3a17 17 0 0 0 0 18"/><path d="M12.5 3a17 17 0 0 1 0 18"/></svg>',
    'building-monument': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 19h14a2 2 0 0 0 2 -2v-10a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2z"/><path d="M6 16h12"/><path d="M9 5v-2"/><path d="M15 5v-2"/><path d="M9 19v2"/><path d="M15 19v2"/><path d="M4 8h16"/></svg>',
    'clock': '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9"/><path d="M12 7v5l3 3"/></svg>'
};

var DAY_INFO = [
    {date: 'Feb 23, 2026', day: 'Monday'},
    {date: 'Feb 24, 2026', day: 'Tuesday'},
    {date: 'Feb 25, 2026', day: 'Wednesday'},
    {date: 'Feb 26, 2026', day: 'Thursday'},
    {date: 'Feb 27, 2026', day: 'Friday'},
    {date: 'Feb 28, 2026', day: 'Saturday'},
    {date: 'Mar 1, 2026', day: 'Sunday'},
    {date: 'Mar 2, 2026', day: 'Monday'},
    {date: 'Mar 3, 2026', day: 'Tuesday'},
    {date: 'Mar 4, 2026', day: 'Wednesday'}
];

function formatHour(h) {
    return (h < 10 ? '0' : '') + h + ':00';
}

function renderHourlySchedule(dayIndex) {
    var container = document.getElementById('timeline-container');
    var events = SCHEDULE_HOURLY[dayIndex] || [];
    
    if (events.length === 0) {
        container.innerHTML = '<div class="no-events"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="4" y="5" width="16" height="16" rx="2"/><line x1="16" y1="3" x2="16" y2="7"/><line x1="8" y1="3" x2="8" y2="7"/><line x1="4" y1="11" x2="20" y2="11"/></svg><p>é€™å¤©æ²’æœ‰å®‰æ’è¡Œç¨‹</p></div>';
        return;
    }
    
    // æ‰¾å‡ºè¡Œç¨‹è¦†è“‹çš„æ™‚é–“ç¯„åœ
    var minHour = 24, maxHour = 0;
    events.forEach(function(e) {
        if (e.hour < minHour) minHour = e.hour;
        var endHour = e.hour + Math.ceil(e.duration);
        if (endHour > maxHour) maxHour = endHour;
    });
    
    // æ“´å±•ç¯„åœå‰å¾Œå„1å°æ™‚
    minHour = Math.max(0, minHour - 1);
    maxHour = Math.min(24, maxHour + 1);
    
    // å»ºç«‹å°æ™‚-äº‹ä»¶å°ç…§è¡¨
    var hourEvents = {};
    events.forEach(function(event) {
        if (!hourEvents[event.hour]) hourEvents[event.hour] = [];
        hourEvents[event.hour].push(event);
    });
    
    var html = '';
    for (var h = minHour; h < maxHour; h++) {
        var hourEvts = hourEvents[h] || [];
        var eventsHtml = hourEvts.map(function(evt) {
            var icon = ICONS[evt.icon] || '';
            var descHtml = evt.desc ? '<div class="event-desc">' + evt.desc.replace(/\\n/g, '<br>') + '</div>' : '';
            var endHour = evt.hour + evt.duration;
            var timeDetail = formatHour(evt.hour) + ' - ' + formatHour(Math.floor(endHour)) + ':' + (Math.floor((endHour % 1) * 60) || '00');
            
            // è¨ˆç®—å¡ç‰‡é«˜åº¦ï¼ˆæ¯å°æ™‚ç´„80pxï¼‰
            var cardHeight = evt.duration >= 2 ? (evt.duration * 70) + 'px' : 'auto';
            var heightStyle = evt.duration >= 2 ? ' style="min-height:' + cardHeight + '"' : '';
            
            return '<div class="event-card ' + evt.type + '"' + heightStyle + '>' +
                '<div class="event-title-text">' + icon + evt.title + '</div>' +
                '<div class="event-meta">' +
                '<span class="event-time-detail">' + ICONS.clock + timeDetail + '</span>' +
                '<span class="event-tag">' + evt.tag + '</span>' +
                '</div>' +
                descHtml +
                '</div>';
        }).join('');
        
        html += '<div class="hour-block">' +
            '<div class="hour-time">' + formatHour(h) + '</div>' +
            '<div class="hour-line">' +
            '<div class="hour-dot"></div>' +
            eventsHtml +
            '</div></div>';
    }
    
    container.innerHTML = '<div class="hourly-schedule">' + html + '</div>';
}

var currentScheduleDay = 0;

function showScheduleDay(dayIndex) {
    currentScheduleDay = dayIndex;
    document.getElementById('schedule-day-num').textContent = dayIndex + 1;
    document.getElementById('schedule-current-date').textContent = DAY_INFO[dayIndex].date;
    
    document.querySelectorAll('.week-day').forEach(function(day, idx) {
        day.classList.toggle('active', idx === dayIndex);
    });
    
    var activeDay = document.querySelector('.week-day.active');
    if (activeDay) {
        activeDay.scrollIntoView({behavior: 'smooth', block: 'nearest', inline: 'center'});
    }
    
    renderHourlySchedule(dayIndex);
}

document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.week-day').forEach(function(day) {
        day.addEventListener('click', function() {
            var dayIndex = parseInt(this.getAttribute('data-day'));
            showScheduleDay(dayIndex);
        });
    });
    
    renderHourlySchedule(0);
});


var touchStartX = 0;
var touchEndX = 0;

function jumpToToday() {
    showScheduleDay(0);
}

function toggleEventDetails(element) {
    element.classList.toggle('event-expanded');
    element.classList.toggle('event-collapsed');
}

// æ»‘å‹•åˆ‡æ›æ—¥æœŸ
if (document.getElementById('schedule-content')) {
    var scheduleContent = document.getElementById('schedule-content');
    
    scheduleContent.addEventListener('touchstart', function(e) {
        touchStartX = e.changedTouches[0].screenX;
    }, {passive: true});
    
    scheduleContent.addEventListener('touchend', function(e) {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
    }, {passive: true});
    
    function handleSwipe() {
        var diff = touchStartX - touchEndX;
        if (Math.abs(diff) > 80) { // æœ€å°æ»‘å‹•è·é›¢
            if (diff > 0 && currentScheduleDay < 9) {
                // å·¦æ»‘ - ä¸‹ä¸€å¤©
                showScheduleDay(currentScheduleDay + 1);
            } else if (diff < 0 && currentScheduleDay > 0) {
                // å³æ»‘ - å‰ä¸€å¤©
                showScheduleDay(currentScheduleDay - 1);
            }
        }
    }
}

// ç•¶å‰æ™‚é–“æŒ‡ç¤ºç·šï¼ˆåƒ… Day 1 é¡¯ç¤ºï¼‰
function updateCurrentTimeLine() {
    var now = new Date();
    var currentHour = now.getHours();
    var currentMinute = now.getMinutes();
    
    if (currentScheduleDay === 0) { // åªåœ¨ Day 1 é¡¯ç¤º
        var timeInHours = currentHour + (currentMinute / 60);
        var container = document.getElementById('timeline-container');
        var existingLine = container.querySelector('.current-time-line');
        
        if (existingLine) {
            existingLine.remove();
        }
        
        // ç°¡åŒ–ï¼šä¸é¡¯ç¤ºç•¶å‰æ™‚é–“ç·šï¼ˆå› ç‚ºæ˜¯æœªä¾†æ—¥æœŸï¼‰
    }
}

// æ›´æ–° renderHourlySchedule åŠ å…¥ current time line
var originalRenderHourlySchedule = renderHourlySchedule;

function showDay(i) {
    showScheduleDay(i);
}

var ICONS = {
    'plane': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 10h4a2 2 0 0 1 0 4h-4l-4 7h-3l2 -7h-4l-2 2h-3l2 -4l-2 -4h3l2 2h4l-2 -7h3z"/></svg>',
    'plane-arrival': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 12h5a2 2 0 0 1 0 4h-15l-3 6h-2l2 -8h-2l-2 2h-2l2 -4l-2 -4h2l2 2h2l-2 -8h2l3 6h10a2 2 0 0 1 0 4h-5z"/></svg>',
    'home': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12l-2 0l9 -9l9 9l-2 0l0 7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"/></svg>',
    'briefcase': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"/><path d="M8 7v-2a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v2"/><path d="M12 12l0 .01"/><path d="M3 13a20 20 0 0 0 18 0"/></svg>',
    'bowl': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 8h16a1 1 0 0 1 1 1v.5c0 1.5 -2.517 5.573 -4 6.5v1a1 1 0 0 1 -1 1h-8a1 1 0 0 1 -1 -1v-1c-1.687 -1.054 -4 -5 -4 -6.5v-.5a1 1 0 0 1 1 -1z"/><path d="M12 4a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"/></svg>',
    'confetti': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 5h2"/><path d="M5 4v2"/><path d="M11.5 4l-.5 2"/><path d="M18 5h2"/><path d="M19 4v2"/><path d="M15 9l-1 1"/><path d="M18 13l2 -.5"/><path d="M18 19h2"/><path d="M19 18v2"/><path d="M14 16.518l-6.518 -6.518l-4.39 9.58a1 1 0 0 0 1.329 1.329l9.579 -4.39z"/></svg>',
    'lantern': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 2h6l3 7l-3 7h-6l-3 -7z"/><path d="M12 16v4"/><path d="M10 20h4"/></svg>',
    'mountain': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 20h18l-6.921 -14.612a2.3 2.3 0 0 0 -4.158 0l-6.921 14.612z"/><path d="M7.5 11l2 2.5l2.5 -2.5l2 3l2.5 -2"/></svg>',
    'car': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/><path d="M5 17h-2v-6l2 -5h9l4 5h1a2 2 0 0 1 2 2v4h-2m-4 0h-6m-6 -6h15m-6 0v-5"/></svg>',
    'church': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 21h18"/><path d="M10 21v-4a2 2 0 0 1 2 -2h0a2 2 0 0 1 2 2v4"/><path d="M10 5l2 -2l2 2"/><path d="M6 21v-7m-2 2l8 -8l8 8m-2 -2v7"/></svg>',
    'shopping-bag': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6.331 8h11.339a2 2 0 0 1 1.977 2.304l-1.255 8.152a3 3 0 0 1 -2.966 2.544h-6.852a3 3 0 0 1 -2.965 -2.544l-1.255 -8.152a2 2 0 0 1 1.977 -2.304z"/><path d="M9 11v-5a3 3 0 0 1 6 0v5"/></svg>',
    'world': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9"/><path d="M3.6 9h16.8"/><path d="M3.6 15h16.8"/><path d="M11.5 3a17 17 0 0 0 0 18"/><path d="M12.5 3a17 17 0 0 1 0 18"/></svg>',
    'building-monument': '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 19h14a2 2 0 0 0 2 -2v-10a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2z"/><path d="M6 16h12"/><path d="M9 5v-2"/><path d="M15 5v-2"/><path d="M9 19v2"/><path d="M15 19v2"/><path d="M4 8h16"/></svg>'
};

var DAY_INFO = [
    {date: 'Feb 23, 2026', day: 'Monday'},
    {date: 'Feb 24, 2026', day: 'Tuesday'},
    {date: 'Feb 25, 2026', day: 'Wednesday'},
    {date: 'Feb 26, 2026', day: 'Thursday'},
    {date: 'Feb 27, 2026', day: 'Friday'},
    {date: 'Feb 28, 2026', day: 'Saturday'},
    {date: 'Mar 1, 2026', day: 'Sunday'},
    {date: 'Mar 2, 2026', day: 'Monday'},
    {date: 'Mar 3, 2026', day: 'Tuesday'},
    {date: 'Mar 4, 2026', day: 'Wednesday'}
];

var currentScheduleDay = 0;



var D=[{cn:"æ¸…å’Œå±‹ ä¹™æ”¯è·¯ç›´ç‡Ÿåº—",kr:"ì²­ì™€ì˜¥ ì„ì§€ë¡œ3ê°€ì§ì˜ì ",cat:"ç¾é£Ÿ",note:"åŠ‰åœ¨çŸ³æ¨è–¦æ¹¯é£¯",hours:"08:00-22:00",zone:"æ˜æ´/é¾è·¯",lat:37.566,lon:126.99,must:"æ‹›ç‰Œï¼šè±¬è‚‰æ¹¯é£¯ã€å…§è‡Ÿæ¹¯é£¯",price:"â‚©10,000-15,000"},{cn:"å€«æ•¦è²æœåšç‰©é¤¨ å®‰åœ‹åº—",kr:"ëŸ°ë˜ë² ì´ê¸€ë®¤ì§€ì—„ ì•ˆêµ­ì ",cat:"æ—©åˆé¤",note:"æ¨å¤§è’œå£å‘³",hours:"08:00-18:00",zone:"æ˜æ´/é¾è·¯",lat:37.579,lon:126.986,must:"å¿…é»ï¼šå¤§è’œè²æœã€å¥¶æ²¹èµ·å¸æŠ¹é†¬",price:"â‚©5,000-12,000"},{cn:"æ–°ä»™é›ªæ¿ƒæ¹¯ æ˜æ´åº—",kr:"ì‹ ì„ ì„¤ë†íƒ• ëª…ë™ì ",cat:"ç¾é£Ÿ",note:"å»ºè­°åŠ é¹½å·´",hours:"24å°æ™‚",zone:"æ˜æ´/é¾è·¯",lat:37.565,lon:126.987,must:"æ‹›ç‰Œï¼šç‰›éª¨é›ªæ¿ƒæ¹¯",price:"â‚©12,000-15,000"},{cn:"ç„¡å¢å±‹",kr:"ë¬´êµ¬ì˜¥",cat:"ç¾é£Ÿ",note:"12:00é–‹æ”¾è¨‚ä½",hours:"11:30-21:00",zone:"æ˜æ´/é¾è·¯",lat:37.578,lon:126.981,must:"å¿…é»ï¼šé®‘é­šç²¥ã€æµ·é®®ç²¥ã€å—ç“œç²¥",price:"â‚©15,000-25,000"},{cn:"æœæœåˆ€å‰Šéºµ å¸‚å»³åº—",kr:"ì¡°ì¡°ì¹¼êµ­ìˆ˜ ì‹œì²­ì ",cat:"ç¾é£Ÿ",hours:"10:00-21:30",zone:"æ˜æ´/é¾è·¯",lat:37.562,lon:126.975,must:"æ‹›ç‰Œï¼šæ‰‹å·¥åˆ€å‰Šéºµã€é¤ƒå­",price:"â‚©9,000-13,000"},{cn:"è±¬ä»”å­˜éŒ¢ç­’",kr:"ë¼ì§€ì €ê¸ˆí†µ",cat:"ç¾é£Ÿ",note:"å¼˜å¤§ç«™8è™Ÿå‡ºå£",hours:"14:00-02:00",zone:"å¼˜å¤§/å»¶å—",lat:37.556,lon:126.926,must:"å¿…é»ï¼šé®®çƒ¤äº”èŠ±è‚‰ã€è±¬é ¸è‚‰",price:"â‚©15,000-20,000/äºº"},{cn:"æ©‹æ‘ç­†æˆ¿",kr:"êµì´Œí•„ë°©",cat:"ç¾é£Ÿ",note:"é€±ä¸€å…¬ä¼‘",hours:"16:00-23:30",zone:"æ¼¢å—/æ¢¨æ³°é™¢",lat:37.526,lon:127.001,must:"æ‹›ç‰Œï¼šç‚­ç«é›è‚‰ä¸²",price:"â‚©3,000-6,000/ä¸²"},{cn:"JO & DAWSON",kr:"ì¡°ì•¤ë„ìŠ¨",cat:"å’–å•¡ç”œé»",note:"ç„¦ç³–å¸ƒä¸ååº—",hours:"12:00-21:00",zone:"å¼˜å¤§/å»¶å—",lat:37.564,lon:126.923,must:"å¿…é»ï¼šç„¦ç³–å¸ƒä¸ã€å·´æ–¯å…‹èµ·å¸è›‹ç³•",price:"â‚©8,000-15,000"},{cn:"é”æ‘©å‰ ä¹™æ”¯è·¯åº—",kr:"ë‹¬ë§ˆì§€ ì„ì§€ë¡œì ",cat:"ç¾é£Ÿ",note:"æœ€å¾Œé»é¤01:00",hours:"16:00-02:00",zone:"æ˜æ´/é¾è·¯",lat:37.566,lon:126.999,must:"æ¨è–¦ï¼šç‚¸é›ã€å•¤é…’å¥—é¤",price:"â‚©18,000-25,000"},{cn:"é¾é¾å…ˆç”Ÿ è–æ°´åº—",kr:"ìš©ìš©ì„ ìƒ ì„±ìˆ˜ì ",cat:"ç¾é£Ÿ",note:"æœ€å¾Œé»é¤21:00",hours:"16:00-22:00",zone:"è–æ°´æ´",lat:37.544,lon:127.057,must:"å¿…é»ï¼šéº»è¾£é¦™é‹ã€æ°´ç…®ç‰›è‚‰",price:"â‚©15,000-25,000"},{cn:"é˜ä¸‰å…­",kr:"ì¢…ì‚¼ìœ¡",cat:"ç¾é£Ÿ",note:"é˜è·¯ä¸‰è¡—ç«™",hours:"14:00-23:30",zone:"æ˜æ´/é¾è·¯",lat:37.573,lon:126.99,must:"æ‹›ç‰Œï¼šéŸ“ç‰›ç‡’è‚‰ã€ç‰›äº”èŠ±",price:"â‚©30,000-50,000/äºº"},{cn:"å­«å®¶ç‡‰é›",kr:"ì†ê°€ë„¤ë‹­í•œë§ˆë¦¬",cat:"ç¾é£Ÿ",note:"éš±è—ç‰ˆååº—",hours:"11:00-22:00",zone:"æ˜æ´/é¾è·¯",lat:37.574,lon:127.021,must:"å¿…é»ï¼šä¸€éš»é›ç‡‰é‹",price:"â‚©25,000-30,000"},{cn:"çµ±ç‡Ÿè’¸ç‰¡è £",kr:"í†µì˜êµ´ì°œ",cat:"ç¾é£Ÿ",note:"å­£ç¯€é™å®š",hours:"11:00-22:00",zone:"æ±çŸ£å³¶",lat:37.527,lon:126.924,must:"æ‹›ç‰Œï¼šè’¸ç‰¡è £å¥—é¤",price:"â‚©25,000-40,000"},{cn:"ç„¡å¢å±‹ è–æ°´åº—",kr:"ë¬´êµ¬ì˜¥ ì„±ìˆ˜ì ",cat:"ç¾é£Ÿ",note:"è–æ°´ç«™åˆ†åº—",hours:"11:30-21:00",zone:"è–æ°´æ´",lat:37.545,lon:127.059,must:"å¿…é»ï¼šé®‘é­šç²¥ã€å—ç“œç²¥",price:"â‚©15,000-25,000"},{cn:"æ¼¢å—æ´é¦¬éˆ´è–¯æ’éª¨æ¹¯",kr:"í•œë‚¨ë™ê°ìíƒ•",cat:"ç¾é£Ÿ",note:"å¿…åƒè€åº—",hours:"24å°æ™‚",zone:"æ¼¢å—/æ¢¨æ³°é™¢",lat:37.531,lon:126.997,must:"æ‹›ç‰Œï¼šé¦¬éˆ´è–¯æ’éª¨æ¹¯",price:"â‚©12,000-20,000"},{cn:"Parole & Langue",kr:"íŒŒë¡¤ì•¤ë‘ê·¸",cat:"å’–å•¡ç”œé»",note:"å¡”é¡ç”œé»ç†±é–€åº—",hours:"13:00-21:00",zone:"å¼˜å¤§/å»¶å—",lat:37.565,lon:126.923,must:"å¿…é»ï¼šæ°´æœå¡”ã€å·§å…‹åŠ›å¡”",price:"â‚©8,000-15,000"},{cn:"Buttyä¸‰æ˜æ²»",kr:"ë²„í‹°ìƒŒë“œìœ„ì¹˜",cat:"å’–å•¡ç”œé»",note:"å·§å·´é”ä¸‰æ˜æ²»",hours:"11:00-19:00",zone:"å¼˜å¤§/å»¶å—",lat:37.556,lon:126.901,must:"æ‹›ç‰Œï¼šå·§å·´é”ä¸‰æ˜æ²»",price:"â‚©8,000-12,000"},{cn:"é¦¬å±±è€å¥¶å¥¶é®Ÿé±‡é­šè’¸",kr:"ë§ˆì‚°í• ë§¤ì•„êµ¬ì°œ",cat:"ç¾é£Ÿ",note:"åœ¨åœ°å£ç¢‘åº—",hours:"11:00-22:00",zone:"æ¼¢å—/æ¢¨æ³°é™¢",lat:37.55,lon:126.98,must:"å¿…é»ï¼šè¾£è’¸é®Ÿé±‡é­š",price:"â‚©35,000-50,000"},{cn:"hetras è–æ°´",kr:"í—¤íŠ¸ë¼ìŠ¤ ì„±ìˆ˜",cat:"è³¼ç‰©",note:"æ¨è–¦No.29,No.7,No.5",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.541,lon:127.06,must:"å¿…è²·ï¼šé¦™æ°´No.29ã€No.7ã€No.5",price:"â‚©80,000-150,000"},{cn:"newmix coffee",kr:"ë‰´ë¯¹ìŠ¤ì»¤í”¼",cat:"å’–å•¡ç”œé»",note:"å¿…è²·å³æº¶å’–å•¡ä¼´æ‰‹ç¦®",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.541,lon:127.06,must:"å¿…è²·ï¼šå³æº¶å’–å•¡ç¦®ç›’",price:"â‚©15,000-35,000"},{cn:"ADERERROR è–æ°´",kr:"ì•„ë” ì„±ìˆ˜ ìŠ¤í˜ì´ìŠ¤",cat:"æœé£¾",note:"æ——è‰¦æ¦‚å¿µåº—",hours:"13:00-21:00",zone:"è–æ°´æ´",lat:37.536,lon:127.054,must:"æ¨è–¦ï¼šç¶“å…¸Logoè¡›è¡£",price:"â‚©100,000-400,000"},{cn:"BLUE ELEPHANT è–æ°´",kr:"ë¸”ë£¨ì—˜ë¦¬í€íŠ¸ ì„±ìˆ˜",cat:"æœé£¾",note:"å¹³åƒ¹å¢¨é¡å“ç‰Œ",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.541,lon:127.057,must:"å¿…è²·ï¼šå¹³åƒ¹å¤ªé™½çœ¼é¡",price:"â‚©25,000-60,000"},{cn:"fwee Agit",kr:"í“Œ ì•„ì§€íŠ¸",cat:"å½©å¦",note:"å¿…è²·å¸ƒä¸å”‡æ³¥",hours:"11:00-21:00",zone:"è–æ°´æ´",lat:37.543,lon:127.054,must:"å¿…è²·ï¼šå¸ƒä¸å”‡æ³¥ã€å…‰æ¾¤å”‡èœœ",price:"â‚©15,000-30,000"},{cn:"DIOR è–æ°´",kr:"ë””ì˜¬ ì„±ìˆ˜",cat:"æ™¯é»",note:"ç†±é–€åœ°æ¨™æ‹ç…§",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.544,lon:127.053,must:"æ‹ç…§æ‰“å¡é»",price:"å…è²»å…¥å ´"},{cn:"NYUNYU è–æ°´",kr:"ë‰´ë‰´ ì„±ìˆ˜",cat:"æœé£¾",note:"é£¾å“è³¼ç‰©è–åœ°",hours:"11:00-23:00",zone:"è–æ°´æ´",lat:37.545,lon:127.056,must:"å¿…è²·ï¼šéŸ“ç³»é£¾å“ã€è€³ç’°",price:"â‚©10,000-50,000"},{cn:"ëµêµ´ è–æ°´",kr:"ëµêµ´ìŠ¤í† ì–´ ì„±ìˆ˜",cat:"é¸ç‰©",note:"ç”Ÿæ´»é¸ç‰©åº—",hours:"11:00-21:00",zone:"è–æ°´æ´",lat:37.541,lon:127.057,must:"æ¨è–¦ï¼šæ–‡å…·é›œè²¨ã€é¦™æ°›è Ÿç‡­",price:"â‚©10,000-80,000"},{cn:"KODAK æ±å¤§é–€",kr:"ì½”ë‹¥ì–´íŒ¨ëŸ´ ë™ëŒ€ë¬¸",cat:"æœé£¾",note:"ä½æ–¼DunDun 2æ¨“",hours:"10:30-22:00",zone:"æ˜æ´/é¾è·¯",lat:37.569,lon:127.011,must:"å¿…è²·ï¼šå¾©å¤é¢¨å¤–å¥—ã€å¸½T",price:"â‚©50,000-150,000"},{cn:"ept è–æ°´",kr:"ì´í”¼í‹° ì„±ìˆ˜",cat:"æœé£¾",note:"éŸ“åœ‹ç†±é–€é‹å‹•é‹",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.541,lon:127.06,must:"å¿…è²·ï¼šéŸ“åœ‹ç†±é–€é‹å‹•é‹",price:"â‚©100,000-200,000"},{cn:"HAUS NOWHERE",kr:"í•˜ìš°ìŠ¤ ë…¸ì›¨ì–´",cat:"é¸ç‰©",note:"è‡˜è…¸ç‹—åœ°æ¨™",hours:"11:00-21:00",zone:"è–æ°´æ´",lat:37.541,lon:127.059,must:"æ¨è–¦ï¼šè¨­è¨ˆå¸«å“ç‰Œæœé£¾",price:"â‚©80,000-300,000"},{cn:"thisisneverthat",kr:"ë””ìŠ¤ì´ì¦ˆë„¤ë²„ëŒ“",cat:"æœé£¾",note:"è¡—é ­æ½®æµç¬¬ä¸€ç«™",hours:"12:00-21:00",zone:"å¼˜å¤§/å»¶å—",lat:37.552,lon:126.92,must:"å¿…è²·ï¼šè¡—é ­æ½®æµTæ¤ã€è¡›è¡£",price:"â‚©50,000-200,000"},{cn:"KITH é¦–çˆ¾",kr:"í‚¤ìŠ¤ ì„œìš¸",cat:"æœé£¾",note:"æ½®æµååº—",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.541,lon:127.06,must:"æ¨è–¦ï¼šè¯åé™å®šæ¬¾",price:"â‚©100,000-500,000"},{cn:"HUMAN MADE",kr:"íœ´ë¨¼ë©”ì´ë“œ",cat:"æœé£¾",note:"ç†±é–€æ½®ç‰Œ",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.541,lon:127.054,must:"å¿…è²·ï¼šç¶“å…¸æ„›å¿ƒLogo",price:"â‚©150,000-400,000"},{cn:"MUSINSA EMPTY",kr:"ë¬´ì‹ ì‚¬ ì— í”„í‹°",cat:"é¸ç‰©",note:"å¤§å‹é¸å“åº—",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.536,lon:127.054,must:"æ¨è–¦ï¼šéŸ“åœ‹è¨­è¨ˆå¸«å“ç‰Œ",price:"â‚©30,000-300,000"},{cn:"æ¸…æ°´å ‚",kr:"ì²­ìˆ˜ë‹¹",cat:"å’–å•¡ç”œé»",note:"ç›Šå–„æ´ç«¹æ—é€ æ™¯",hours:"11:30-22:00",zone:"æ˜æ´/é¾è·¯",lat:37.574,lon:126.991,must:"å¿…é»ï¼šç«¹æ—åº§ä½å€æ‹ç…§ã€ç´…è±†ç²¥",price:"â‚©8,000-15,000"},{cn:"YM Coffee House",kr:"YMì»¤í”¼í•˜ìš°ìŠ¤",cat:"å’–å•¡ç”œé»",note:"æ•™å ‚é¢¨æ ¼å°ˆæ¥­æ‰‹æ²–",hours:"12:00-22:00",zone:"é¦–çˆ¾å¸‚å€",lat:37.62,lon:126.917,must:"æ¨è–¦ï¼šæ‰‹æ²–å’–å•¡",price:"â‚©6,000-12,000"},{cn:"Cafe Layered å»¶å—åº—",kr:"ì¹´í˜ ë ˆì´ì–´ë“œ ì—°ë‚¨ì ",cat:"å’–å•¡ç”œé»",note:"å¸åº·ååº—",hours:"11:00-22:00",zone:"å¼˜å¤§/å»¶å—",lat:37.565,lon:126.924,must:"å¿…é»ï¼šå¸åº·ã€å¥¶æ²¹å¸åº·",price:"â‚©5,000-10,000"},{cn:"Thanks Oat å»¶å—",kr:"ë•¡ìŠ¤ì˜¤íŠ¸ ì—°ë‚¨",cat:"å’–å•¡ç”œé»",note:"å»¶å—æ´æ‰‹å·¥å„ªæ ¼",hours:"10:00-19:00",zone:"å¼˜å¤§/å»¶å—",lat:37.565,lon:126.921,must:"å¿…é»ï¼šæ‰‹å·¥å„ªæ ¼ã€ç‡•éº¥ç¢—",price:"â‚©8,000-15,000"},{cn:"ä»Šå¤©ä¹Ÿè¶³å¤ ",kr:"ì˜¤ëŠ˜ë„ì¶©ë¶„í•´",cat:"å’–å•¡ç”œé»",note:"é€±äºŒå…¬ä¼‘",hours:"12:00-20:00",zone:"å¼˜å¤§/å»¶å—",lat:37.56,lon:126.925,must:"æ¨è–¦ï¼šè›‹ç³•ã€æ‰‹å·¥ç”œé»",price:"â‚©7,000-15,000"},{cn:"ç´ è³¢å ‚",kr:"ì†Œí˜„ë‹¹",cat:"å’–å•¡ç”œé»",note:"éŸ“å±‹èŒ¶å®¤",hours:"11:00-20:00",zone:"æ˜æ´/é¾è·¯",lat:37.58,lon:126.981,must:"å¿…é»ï¼šå‚³çµ±éŸ“èŒ¶ã€è—¥è“",price:"â‚©10,000-18,000"},{cn:"Artist Bakery",kr:"ì•„í‹°ìŠ¤íŠ¸ ë² ì´ì»¤ë¦¬",cat:"å’–å•¡ç”œé»",note:"é¹½å¯é Œæ’éšŠååº—",hours:"08:00-20:00",zone:"æ˜æ´/é¾è·¯",lat:37.576,lon:126.984,must:"å¿…é»ï¼šé¹½å¯é Œ",price:"â‚©4,000-8,000"},{cn:"29CM è–æ°´",kr:"ì´êµ¬ì„±ìˆ˜",cat:"é¸ç‰©",note:"ç·šä¸Šé¸å“å¯¦é«”åº—",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.545,lon:127.053,must:"æ¨è–¦ï¼šéŸ“åœ‹è¨­è¨ˆå¸«å“ç‰Œ",price:"â‚©30,000-200,000"},{cn:"Ground Seesaw è¥¿æ‘",kr:"ê·¸ë¼ìš´ë“œì‹œì†Œ ì„œì´Œ",cat:"å±•è¦½",note:"è³ªæ„Ÿå±•è¦½ç©ºé–“",hours:"10:00-19:00",zone:"æ˜æ´/é¾è·¯",lat:37.578,lon:126.973,must:"æ¨è–¦ï¼šç•¶æœŸå±•è¦½",price:"â‚©15,000-20,000"},{cn:"å»£è—å¸‚å ´ 156è™Ÿ",kr:"ê´‘ì¥ì‹œì¥ 156í˜¸",cat:"é›œè²¨",note:"è³¼è²·éŸ“åœ‹è£½æ£‰è¢«",hours:"09:00-18:00",zone:"æ˜æ´/é¾è·¯",lat:37.57,lon:127,must:"å¿…è²·ï¼šéŸ“åœ‹è£½æ‰‹å·¥æ£‰è¢«",price:"â‚©100,000-500,000"},{cn:"Cociety é¦–çˆ¾æ—",kr:"ì½”ì‚¬ì´ì–´í‹° ì„œìš¸ìˆ²",cat:"å·¥ä½œå’–å•¡",note:"å‰µæ„å·¥ä½œç©ºé–“(é€±ä¸€ä¼‘)",hours:"12:00-20:00",zone:"è–æ°´æ´",lat:37.556,lon:127.043,must:"æ¨è–¦ï¼šå’–å•¡ã€ç”œé»",price:"â‚©6,000-12,000"},{cn:"Brautor",kr:"ë¸Œë¼ìš°í„°",cat:"å·¥ä½œå’–å•¡",note:"è´è¶é¤…ååº—",hours:"08:00-22:00",zone:"è–æ°´æ´",lat:37.549,lon:127.045,must:"å¿…é»ï¼šè´è¶é¤…",price:"â‚©5,000-12,000"},{cn:"Debunk",kr:"ë””ë²™í¬",cat:"å·¥ä½œå’–å•¡",note:"åœ°ä¸‹å±¤è®€æ›¸æ°›åœ",hours:"10:00-23:00",zone:"å¼˜å¤§/å»¶å—",lat:37.548,lon:126.915,must:"æ¨è–¦ï¼šå’–å•¡",price:"â‚©5,000-10,000"},{cn:"Hollys Coffee å¼˜å¤§ç«™",kr:"í• ë¦¬ìŠ¤ í™ëŒ€ì—­ì ",cat:"å·¥ä½œå’–å•¡",note:"24å°æ™‚",hours:"24å°æ™‚",zone:"å¼˜å¤§/å»¶å—",lat:37.556,lon:126.923,must:"æ¨è–¦ï¼šç¾å¼å’–å•¡",price:"â‚©5,000-12,000"},{cn:"Ediya Coffee Lab",kr:"ì´ë””ì•¼ì»¤í”¼ë©",cat:"å·¥ä½œå’–å•¡",note:"æ——è‰¦åº—",hours:"07:30-02:00",zone:"æ±Ÿå—",lat:37.511,lon:127.033,must:"æ¨è–¦ï¼šå’–å•¡ã€ç”œé»",price:"â‚©4,000-10,000"},{cn:"Terarosa POSCO",kr:"í…Œë¼ë¡œì‚¬ í¬ìŠ¤ì½”ì„¼í„°ì ",cat:"å·¥ä½œå’–å•¡",note:"é‹¼éµæ›¸æ¶ç‰†",hours:"07:30-21:00",zone:"æ±Ÿå—",lat:37.506,lon:127.056,must:"æ¨è–¦ï¼šæ‰‹æ²–å’–å•¡",price:"â‚©6,000-15,000"},{cn:"1äºº1æ¯",kr:"1äºº1æ¯",cat:"å’–å•¡ç”œé»",note:"çµ•ç¾ç’°æ™¯",hours:"11:00-21:00",zone:"æ©å¹³å€",lat:37.641,lon:126.938},{cn:"Dotom",kr:"Dotom",cat:"ç¾é£Ÿ",note:"åœ¨åœ°äººä¸‹ç­å¾Œæœƒä¾†åƒçš„çƒ¤è‚‰åº—",hours:"17:00-23:00",zone:"å»ºå¤§/å»£æ´¥å€",lat:37.556,lon:127.078,must:"æ¨è–¦ï¼šçƒ¤è‚‰",price:"â‚©20,000-30,000/äºº"},{cn:"ì†ì¹¼êµ­ìˆ˜ë³´ìŒˆ",kr:"í›¼ë¯¸ë¦¬ì†ì¹¼êµ­ìˆ˜ë³´ìŒˆ",cat:"ç¾é£Ÿ",note:"èœåŒ…è‚‰ åˆ€å‰Šéºµ",hours:"11:00-22:00",zone:"è–æ°´æ´",lat:37.549,lon:127.045,must:"å¿…é»ï¼šèœåŒ…è‚‰ã€åˆ€å‰Šéºµ",price:"â‚©12,000-18,000"},{cn:"è‡ªç„¶å³¶é¹½éºµåŒ…",kr:"Jayeondo Sogeumppang",cat:"å’–å•¡ç”œé»",note:"é¹½éºµåŒ…ååº—",hours:"08:00-20:00",zone:"è–æ°´æ´",lat:37.542,lon:127.055,must:"å¿…è²·ï¼šé¹½éºµåŒ…",price:"â‚©3,000-5,000"},{cn:"Kyewol Gomtang",kr:"Kyewol Gomtang",cat:"ç¾é£Ÿ",note:"æ¹¯é£¯",hours:"24å°æ™‚",zone:"è–æ°´æ´",lat:37.54,lon:127.048,must:"æ‹›ç‰Œï¼šç‰›éª¨æ¹¯é£¯",price:"â‚©10,000-13,000"},{cn:"Thweet Seongsu",kr:"Thweet Seongsu",cat:"å’–å•¡ç”œé»",note:"å¨å£«å¿Œå†°æ·‡æ·‹",hours:"13:00-22:00",zone:"è–æ°´æ´",lat:37.545,lon:127.052,must:"å¿…é»ï¼šå¨å£«å¿Œå†°æ·‡æ·‹",price:"â‚©8,000-12,000"},{cn:"MilkyShop Seongsu",kr:"MilkyShop Seongsu Store",cat:"è³¼ç‰©",note:"ç„¦ç³–å¥¶æ²¹é¤…ä¹¾ä¼´æ‰‹ç¦®",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.544,lon:127.051,must:"å¿…è²·ï¼šç„¦ç³–å¥¶æ²¹é¤…ä¹¾",price:"â‚©12,000-18,000"},{cn:"ç¥–å‚³ä¸‰ä»£é¦¬éˆ´è–¯æ’éª¨æ¹¯",kr:"ì†Œë¬¸ë‚œ ì„±ìˆ˜ ê°ìíƒ•",cat:"ç¾é£Ÿ",note:"24å°æ™‚ç‡Ÿæ¥­",hours:"24å°æ™‚",zone:"è–æ°´æ´",lat:37.543,lon:127.054,must:"æ‹›ç‰Œï¼šé¦¬éˆ´è–¯æ’éª¨æ¹¯",price:"â‚©13,000-18,000"},{cn:"29cm.home",kr:"29cm.home",cat:"é¸ç‰©",note:"è³ªæ„Ÿå®¶å±…é¸ç‰©åº— gelato",hours:"12:00-21:00",zone:"è–æ°´æ´",lat:37.543,lon:127.056,must:"æ¨è–¦ï¼šé–‹å¿ƒæœgelatoã€è¨­è¨ˆé¸ç‰©",price:"â‚©5,000-50,000"},{cn:"LOE SEONGSU",kr:"ë¡œì— ì„±ìˆ˜",cat:"è³¼ç‰©",note:"éŸ“åœ‹å°çœ¾å“ç‰Œé¦™æ°´ å…è²»åˆ»å­—",hours:"11:00-20:00",zone:"è–æ°´æ´",lat:37.542,lon:127.056,must:"å¿…è²·ï¼šå°çœ¾é¦™æ°´ã€å…è²»åˆ»å­—æœå‹™",price:"â‚©50,000-120,000"},{cn:"Standard Bread",kr:"Standard Bread",cat:"å’–å•¡ç”œé»",note:"éµé‹ç„¦ç³–æ³•å¼åå¸",hours:"08:00-19:00",zone:"è–æ°´æ´",lat:37.542,lon:127.061,must:"å¿…é»ï¼šéµé‹ç„¦ç³–æ³•å¼åå¸",price:"â‚©6,000-15,000"},{cn:"Neungdong Minari",kr:"Neungdong Minari Seongsu",cat:"ç¾é£Ÿ",note:"Hebeæ±æµ·ä¾†åƒé",hours:"10:00-22:00",zone:"è–æ°´æ´",lat:37.543,lon:127.054,must:"æ‹›ç‰Œï¼šæ°´èŠ¹ç‰›éª¨æ¹¯",price:"â‚©12,000-15,000"},{cn:"STAFF PICKS",kr:"STAFF PICKS",cat:"å’–å•¡ç”œé»",note:"ç¾å’–å•¡å»³",hours:"10:00-21:00",zone:"é¦–çˆ¾å¸‚å€",lat:37.577,lon:126.968},{cn:"Milestone Coffee",kr:"Milestone Coffee Hannam",cat:"å’–å•¡ç”œé»",note:"æ¼¢å—æ´æ½®æµå€",hours:"09:00-20:00",zone:"æ¼¢å—/æ¢¨æ³°é™¢",lat:37.538,lon:127.003},{cn:"COFFEE & CIGARETTES",kr:"COFFEE & CIGARETTES",cat:"å’–å•¡ç”œé»",note:"17æ¨“é«˜ç©ºå’–å•¡",hours:"11:00-23:00",zone:"æ˜æ´/é¾è·¯",lat:37.563,lon:126.974},{cn:"Blue Bottle ä¸‰æ¸…",kr:"Blue Bottle Samcheong Cafe",cat:"å’–å•¡ç”œé»",note:"é¢¨æ™¯å¾ˆå¥½",hours:"08:00-20:00",zone:"ä¸‰æ¸…æ´",lat:37.58,lon:126.981},{cn:"ë­ MUUT",kr:"ë­ ì„±ìˆ˜ í”Œë˜ê·¸ì‰½ ìŠ¤í† ì–´",cat:"é¸ç‰©",note:"è¨­è¨ˆå“ç‰Œ",hours:"12:00-21:00",zone:"è–æ°´æ´",lat:37.541,lon:127.06},{cn:"åœ‹ç«‹ç¾ä»£ç¾è¡“é¤¨",kr:"åœ‹ç«‹ç¾ä»£ç¾è¡“é¤¨ é¦–çˆ¾ MMCA",cat:"å±•è¦½",note:"éŸ“åœ‹ç•¶ä»£è—è¡“æœ€é«˜æ®¿å ‚",hours:"10:00-18:00",zone:"ä¸‰æ¸…æ´",lat:37.579,lon:126.98,must:"æ¨è–¦ï¼šç•¶æœŸå±•è¦½",price:"â‚©5,000-10,000"},{cn:"é¦–çˆ¾å¸‚ç«‹ç¾è¡“é¤¨",kr:"é¦–çˆ¾å¸‚ç«‹ç¾è¡“é¤¨",cat:"å±•è¦½",note:"ç¾è¡“é¤¨",hours:"10:00-20:00",zone:"æ˜æ´/é¾è·¯",lat:37.564,lon:126.974},{cn:"çœå‘³é£Ÿå ‚",kr:"çœå‘³é£Ÿå ‚",cat:"ç¾é£Ÿ",note:"ç±³å…¶æ—èªè­‰ é†¬èŸ¹å®šé£Ÿ",hours:"11:00-22:00",zone:"é¦–çˆ¾å¸‚å€",lat:37.551,lon:126.956,must:"æ‹›ç‰Œï¼šé†¬èŸ¹å®šé£Ÿ",price:"â‚©45,000/äºº"},{cn:"Ground Seesaw Central",kr:"Ground Seesaw Central",cat:"å±•è¦½",note:"å±•è¦½ç©ºé–“",hours:"11:00-19:00",zone:"é¦–çˆ¾å¸‚å€",lat:37.558,lon:126.974},{cn:"Musinsa Standard",kr:"Musinsa Standard Seongsu",cat:"æœé£¾",note:"åƒ uniqlo ä¾¿å®œç™¼ç†±è¡£",hours:"11:00-21:00",zone:"è–æ°´æ´",lat:37.542,lon:127.059,must:"å¿…è²·ï¼šç™¼ç†±è¡£ã€åŸºæœ¬æ¬¾",price:"â‚©10,000-50,000"},{cn:"Malbang Gukbap",kr:"Malbang Gukbap - Seongsu",cat:"ç¾é£Ÿ",note:"æ¹¯é£¯",hours:"08:00-21:00",zone:"è–æ°´æ´",lat:37.548,lon:127.064,must:"æ‹›ç‰Œï¼šæ¹¯é£¯",price:"â‚©9,000-12,000"},{cn:"papier prost",kr:"íŒŒí”¼ì–´í”„ë¡œìŠ¤íŠ¸",cat:"è³¼ç‰©",note:"æ–‡å…·åº—",hours:"12:00-20:00",zone:"è¥¿æ‘",lat:37.58,lon:126.969},{cn:"é€šä»å¸‚å ´",kr:"é€šä»å¸‚å ´",cat:"æ™¯é»",note:"å¯ä»¥è²·å¡‘è† é¤ç›’",hours:"09:00-19:00",zone:"è¥¿æ‘",lat:37.581,lon:126.971},{cn:"arkisto",kr:"ì•„ë¥´í‚¤ìŠ¤í† ",cat:"è³¼ç‰©",note:"é€›è¡—ä¸€æ¢è¡—",hours:"11:00-20:00",zone:"è¥¿æ‘",lat:37.582,lon:126.972},{cn:"MONOHA Seochon",kr:"ëª¨ë…¸í•˜ ì„œì´Œ",cat:"è³¼ç‰©",note:"é€›è¡—å€åŸŸ",hours:"11:00-20:00",zone:"è¥¿æ‘",lat:37.58,lon:126.972},{cn:"å¤§æ—ç¾è¡“é¤¨",kr:"å¤§æ—ç¾è¡“é¤¨",cat:"å±•è¦½",note:"æ”å½±å±•ç¾è¡“é¤¨",hours:"11:00-19:00",zone:"è¥¿æ‘",lat:37.578,lon:126.973},{cn:"Dancing grandma",kr:"Dancing grandma",cat:"è³¼ç‰©",note:"æ‰‹ç¹”å“",hours:"12:00-18:00",zone:"è¥¿æ‘",lat:37.578,lon:126.971},{cn:"SOLSOT",kr:"SOLSOT",cat:"ç¾é£Ÿ",note:"é‡œé£¯",hours:"11:30-21:00",zone:"è¥¿æ‘",lat:37.578,lon:126.971,must:"æ‹›ç‰Œï¼šé‡œé£¯",price:"â‚©12,000-18,000"},{cn:"ETC Seoul Seochon",kr:"ETC Seoul Seochon",cat:"é¸ç‰©",note:"é¸å“åº—",hours:"12:00-20:00",zone:"è¥¿æ‘",lat:37.577,lon:126.969},{cn:"Folki",kr:"Folki",cat:"å’–å•¡ç”œé»",note:"æ¼‚äº®å’–å•¡å»³",hours:"10:00-21:00",zone:"è¥¿æ‘",lat:37.576,lon:126.969},{cn:"PIZZA SLICE SEOUL",kr:"PIZZA SLICE SEOUL",cat:"ç¾é£Ÿ",note:"æŠ«è–©",hours:"12:00-22:00",zone:"è–æ°´æ´",lat:37.543,lon:127.062,must:"æ¨è–¦ï¼šæŠ«è–©ç‰‡",price:"â‚©5,000-8,000"},{cn:"AIRDROP COFFEE",kr:"AIRDROP COFFEE SEONGSU",cat:"å’–å•¡ç”œé»",note:"è–æ°´å’–å•¡",hours:"09:00-20:00",zone:"è–æ°´æ´",lat:37.544,lon:127.055},{cn:"Downtowner Anguk",kr:"Downtowner Anguk",cat:"ç¾é£Ÿ",note:"é…ªæ¢¨æ¼¢å ¡",hours:"11:00-21:00",zone:"å®‰åœ‹/ä¸‰æ¸…",lat:37.577,lon:126.986,must:"æ‹›ç‰Œï¼šé…ªæ¢¨æ¼¢å ¡",price:"â‚©12,000-16,000"}];
var cat='all',zone='all',q='',map,markers=[],myMarker,mapFilter='all';
var CATS=[{k:'all',l:'å…¨éƒ¨',i:''},{k:'ç¾é£Ÿ',l:'ç¾é£Ÿ',i:''},{k:'å’–å•¡ç”œé»',l:'å’–å•¡',i:''},{k:'è³¼ç‰©',l:'è³¼ç‰©',i:''},{k:'Work',l:'Work',i:''},{k:'ä½å®¿',l:'ä½å®¿',i:''},{k:'æ™¯é»',l:'æ™¯é»',i:''}];
var ZONES=[].concat.apply([],D.map(function(p){return p.zone})).filter(function(v,i,a){return v&&a.indexOf(v)===i}).sort();
var EMO={'ç¾é£Ÿ':'ğŸœ','æ—©åˆé¤':'ğŸ³','å’–å•¡ç”œé»':'â˜•','è³¼ç‰©':'ğŸ›ï¸','æœé£¾':'ğŸ‘•','é¸ç‰©':'ğŸ','å½©å¦':'ğŸ’„','é›œè²¨':'ğŸ“¦','Work':'ğŸ’»','å·¥ä½œå’–å•¡':'ğŸ’»','å±•è¦½':'ğŸ¨','ä½å®¿':'ğŸ ','æ™¯é»':'ğŸ“'};
function match(c,f){return f==='all'||c===f||(f==='è³¼ç‰©'&&['æœé£¾','é¸ç‰©','å½©å¦','é›œè²¨','è³¼ç‰©'].indexOf(c)>=0)||(f==='Work'&&['Work','å·¥ä½œå’–å•¡','å±•è¦½'].indexOf(c)>=0)||(f==='å’–å•¡ç”œé»'&&['å’–å•¡ç”œé»','æ—©åˆé¤'].indexOf(c)>=0)}
function count(c){return D.filter(function(p){return match(p.cat,c)}).length}
function draw(){
    var ts=document.getElementById('tabs');
    var zs=document.getElementById('zones');
    var ls=document.getElementById('list');
    var inf=document.getElementById('info');
    ts.innerHTML=CATS.map(function(c){return '<button class="tab'+(cat===c.k?' active':'')+'" onclick="cat=\''+c.k+'\';draw()">'+(c.i?c.i+' ':'')+c.l+'<span class="tab-count">'+count(c.k)+'</span></button>'}).join('');
    zs.innerHTML='<span class="zone-pill'+(zone==='all'?' active':'')+'" onclick="zone=\'all\';draw()">å…¨éƒ¨åœ°å€</span>'+ZONES.map(function(z){return '<span class="zone-pill'+(zone===z?' active':'')+'" onclick="zone=\''+z+'\';draw()">'+z+'</span>'}).join('');
    var fs=D.filter(function(p){return match(p.cat,cat)&&(zone==='all'||p.zone===zone)&&(!q||p.cn.toLowerCase().indexOf(q)>=0||p.kr.toLowerCase().indexOf(q)>=0||p.zone.toLowerCase().indexOf(q)>=0)});
    inf.textContent='å…± '+fs.length+' å€‹åœ°é»';
    if(fs.length===0){ls.innerHTML='<div class="empty"><div style="font-size:2rem;opacity:0.2;margin-bottom:10px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></div><p>æ‰¾ä¸åˆ°ç¬¦åˆçš„åœ°é»</p></div>';return}
    ls.innerHTML=fs.map(function(p){
        var qe=encodeURIComponent(p.kr||p.cn);
        var cc='cat-'+p.cat;
        var mh=p.must?'<div class="must"><div class="must-text">'+p.must+'</div>'+(p.price?'<span class="price"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:2px"><circle cx="12" cy="12" r="9"/><path d="M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 0 0 0 4h2a2 2 0 0 1 0 4h-2a2 2 0 0 1 -1.8 -1"/><path d="M12 6v2m0 8v2"/></svg> '+p.price+'</span>':'')+'</div>':'';
        return '<div class="card"><div class="card-badges"><span class="badge-cat '+cc+'">'+p.cat+'</span><span class="badge-zone">'+p.zone+'</span></div><div class="name-cn">'+p.cn+'</div><div class="name-kr">'+p.kr+'</div><div class="info"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:inline-block;vertical-align:text-bottom;margin-right:2px"><circle cx="12" cy="12" r="9"/><path d="M12 7v5l3 3"/></svg> '+p.hours+'</div>'+mh+'<div class="actions"><a href="https://www.google.com/maps/search/?api=1&query='+qe+'" target="_blank" class="btn btn-g">Google</a><a href="https://map.naver.com/p/search/'+qe+'" target="_blank" class="btn btn-n">Naver</a></div></div>'
    }).join('')
}
document.getElementById('search').addEventListener('input',function(e){q=e.target.value.toLowerCase().trim();document.getElementById('clear').classList.toggle('show',q.length>0);draw()});
function clearSearch(){document.getElementById('search').value='';q='';document.getElementById('clear').classList.remove('show');draw()}
function toggleSearch(){
    var sw=document.getElementById('search-wrap');
    var si=document.getElementById('search');
    if(!sw.classList.contains('show')){
        sw.classList.add('show');
        setTimeout(function(){sw.classList.add('open')},10);
        setTimeout(function(){si.focus()},300);
    }else{
        sw.classList.remove('open');
        setTimeout(function(){sw.classList.remove('show');clearSearch()},300);
    }
}
function toggleMapFilter(){
    var btn=document.getElementById('map-filter-btn');
    var dropdown=document.getElementById('map-filter-dropdown');
    btn.classList.toggle('open');
    dropdown.classList.toggle('show');
}
// Handle map filter option clicks with event delegation
document.addEventListener('DOMContentLoaded', function() {
    var dropdown = document.getElementById('map-filter-dropdown');
    if (dropdown) {
        dropdown.addEventListener('click', function(e) {
            var option = e.target.closest('.map-filter-option');
            if (option) {
                var value = option.getAttribute('data-value');
                var label = option.getAttribute('data-label');
                // Update button text with the full HTML content of the clicked option
                document.getElementById('map-filter-text').innerHTML = option.innerHTML;
                // Update active state
                document.querySelectorAll('.map-filter-option').forEach(function(o){
                    o.classList.remove('active');
                });
                option.classList.add('active');
                // Close dropdown
                toggleMapFilter();
                // Apply filter
                filterMap(value);
            }
        });
    }
});
document.addEventListener('click',function(e){
    var filter=document.querySelector('.map-filter');
    var dropdown=document.getElementById('map-filter-dropdown');
    var btn=document.getElementById('map-filter-btn');
    if(filter&&!filter.contains(e.target)&&dropdown.classList.contains('show')){
        dropdown.classList.remove('show');
        btn.classList.remove('open');
    }
});
function go(i){
    var pages=document.querySelectorAll('.page');
    var navs=document.querySelectorAll('.nav-item');
    var mw=document.getElementById('map-wrap');
    pages.forEach(function(p){p.classList.remove('active')});
    navs.forEach(function(n,idx){n.classList.toggle('active',idx===i)});
    mw.classList.remove('active');
    if(i===0)pages[0].classList.add('active');
    else if(i===1)pages[1].classList.add('active');
    else if(i===2){mw.classList.add('active');if(!map){initMap()}else{setTimeout(function(){map.invalidateSize()},100)}}
}
function initMap(){
    map=L.map('map',{zoomControl:false}).setView([37.55,127.0],12);
    L.control.zoom({position:'bottomleft'}).addTo(map);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png',{maxZoom:19}).addTo(map);
    D.forEach(function(p,idx){
        if(p.lat&&p.lon){
            var e=EMO[p.cat]||'ğŸ“';
            var ic=L.divIcon({className:'',html:'<div class="custom-marker marker-'+p.cat+'"><span>'+e+'</span></div>',iconSize:[28,28],iconAnchor:[14,28],popupAnchor:[0,-28]});
            var m=L.marker([p.lat,p.lon],{icon:ic}).bindPopup('<b>'+p.cn+'</b><br><span style="color:#888">'+p.cat+' Â· '+p.zone+'</span><a href="https://map.naver.com/p/search/'+encodeURIComponent(p.kr)+'" target="_blank" class="popup-nav">Naver å°èˆª</a>');
            m.category=p.cat;
            m.placeData=p;
            m.placeIndex=idx;
            markers.push(m);
            m.addTo(map)
        }
    });
    updateMapList();
}
function updateMapList(){
    var list=document.getElementById('map-list');
    var filtered=D.filter(function(p){return p.lat&&p.lon&&match(p.cat,mapFilter)});
    list.innerHTML=filtered.map(function(p,idx){
        var gq=encodeURIComponent(p.cn);
        var nq=encodeURIComponent(p.kr);
        var note=p.must||p.cat;
        return '<div class="map-list-item" onclick="focusMarker('+D.indexOf(p)+')">'+
               '<div class="map-item-name">'+p.cn+'</div>'+
               '<div class="map-item-info">'+note+'</div>'+
               '<div class="map-item-links">'+
               '<a href="https://www.google.com/maps/search/?api=1&query='+gq+'" target="_blank" class="map-item-link" onclick="event.stopPropagation()">'+
               '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#4285f4"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>'+
               '</a>'+
               '<a href="https://map.naver.com/p/search/'+nq+'" target="_blank" class="map-item-link" onclick="event.stopPropagation()">'+
               '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#26de81"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>'+
               '</a>'+
               '</div></div>'
    }).join('');
}
function focusMarker(idx){
    var m=markers.find(function(mk){return mk.placeIndex===idx});
    if(m){
        map.setView(m.getLatLng(),15);
        m.openPopup();
        document.querySelectorAll('.map-list-item').forEach(function(item){item.classList.remove('active')});
        var listIdx=D.filter(function(p){return p.lat&&p.lon&&match(p.cat,mapFilter)}).indexOf(D[idx]);
        if(listIdx>=0)document.querySelectorAll('.map-list-item')[listIdx].classList.add('active');
    }
}
function filterMap(f){
    mapFilter=f;
    markers.forEach(function(m){if(match(m.category,f)){m.addTo(map)}else{m.remove()}});
    updateMapList();
}
function locate(){
    if(!navigator.geolocation){alert('ä¸æ”¯æ´å®šä½');return}
    navigator.geolocation.getCurrentPosition(function(pos){
        if(myMarker)myMarker.remove();
        var ic=L.divIcon({className:'',html:'<div class="my-marker"></div>',iconSize:[16,16],iconAnchor:[8,8]});
        myMarker=L.marker([pos.coords.latitude,pos.coords.longitude],{icon:ic}).addTo(map).bindPopup('ğŸ“ ä½ åœ¨é€™è£¡').openPopup();
        map.setView([pos.coords.latitude,pos.coords.longitude],15)
    },function(){alert('ç„¡æ³•å–å¾—ä½ç½®')},{enableHighAccuracy:true})
}
function showDay(idx){
    document.querySelectorAll('.schedule-tab').forEach(function(t,i){t.classList.toggle('active',i===idx)});
    document.querySelectorAll('.schedule-day').forEach(function(d,i){d.classList.toggle('active',i===idx)});
}
draw();
    </script>
</body>
</html>
